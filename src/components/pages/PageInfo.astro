---
import { cn } from '@/utils'

const { class: className, hideComment, path, ...props } = Astro.props
---

<div class={cn('text-base text-sm text-muted-foreground', className)} {...props}>
  <span class='waline-pageview-count' data-counter-label='Post views' data-path={path}></span> views
  {
    !hideComment && (
      <a href='#waline'>
        | <span class='waline-comment-count' data-counter-label='Post comments' data-path={path} /> comments
      </a>
    )
  }
</div>

<script is:inline define:vars={{ path, hideComment }}>
  import { initPostWalineCounters } from '@/utils/pageview'

  const safePath = typeof path === 'string' && path.length > 0 ? path : window.location.pathname
  const shouldCountComment = hideComment !== true

  initPostWalineCounters(safePath, shouldCountComment)
</script>
